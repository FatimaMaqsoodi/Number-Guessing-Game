<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>🎮 Number Guessing Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Custom Styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <!-- Top Bar -->
  <div class="topbar shadow-sm">
    <h1 class="m-0">
      <i class="bi bi-controller"></i> Guess the Number
    </h1>

    <!-- Theme Toggle -->
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme" title="Toggle light/dark">
      <span class="icon" id="themeIcon">🌙</span>
    </button>
  </div>

  <!-- Main Game Card -->
  <div class="container cardlike" id="gameCard">
    <!-- Best Score Badge -->
    {% if session.get('best_score') %}
      <div class="best-score pulse" id="bestScoreBadge">
        <i class="bi bi-award-fill me-1 text-warning"></i> Best Score: {{ session.get('best_score') }} attempts
      </div>
    {% else %}
      <div class="best-score" id="bestScoreBadge" style="display:none;"></div>
    {% endif %}

    <!-- Error Display -->
    {% if error %}
      <div class="alert alert-danger d-flex align-items-center" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <div>{{ error }}</div>
      </div>
    {% endif %}

    {% if not session.get('number_to_guess') %}
      <!-- Range Selection -->
      <form method="POST" action="/" class="range-form">
        <label class="form-label">Choose Range (0–100)</label>
        <div class="d-flex gap-2">
          <input type="number" name="min_val" min="0" max="100" required placeholder="Min" class="form-control">
          <input type="number" name="max_val" min="0" max="100" required placeholder="Max" class="form-control">
        </div>

        <button type="submit" class="mt-3 start-btn">
          <i class="bi bi-play-circle-fill me-1"></i> Start Game
        </button>
      </form>
    {% else %}
      <!-- Dynamic Alert Box -->
      <div id="alertBox" class="alert d-none" role="alert"></div>

      <p class="mt-2 lead">
        🎯 Guess the number between <strong>{{ session.min_val }}</strong> and <strong>{{ session.max_val }}</strong>.
      </p>
      <p id="attempts" class="mb-3 fw-bold">
        Attempts: {{ session.attempts }}/{{ session.max_attempts }}
      </p>

      <!-- Guess Input Row -->
      <div class="guess-row">
        <input type="number" id="guessInput" class="form-control text-center" min="0" max="100" required placeholder="Your guess" autofocus>
        <button id="guessBtn" onclick="makeGuess()">
          <i class="bi bi-send-fill me-1"></i> Submit
        </button>
      </div>

      <!-- Play Again -->
      <button id="playAgain" class="ghost mt-3" style="display:none;" onclick="playAgain()">
        <i class="bi bi-arrow-repeat me-1"></i> Play Again
      </button>

      <!-- High Score Celebration -->
      <button id="newHighScore" class="btn btn-success mt-3 w-100 fw-bold" style="display:none;">
        🏆 New High Score!
      </button>
    {% endif %}
  </div>

  <!-- JS -->
  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
